<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="1.改进在上一篇使用PHP编写留言板的结尾处，写了留言板的不足之处。经过一周的PHP学习，打算重新写一遍留言板，对之前的不足做出改进。 1.1删除功能新的留言板添加了编辑选项，可以修改留言内容或删除留言。 1.2重复提交新的留言板添加了session，而且在提交表单之后会自动跳转到留言板的主页，从而解决了重复提交的Bug。 1.3时间显示问题在上一篇其实已经写出了解决方案，新的留言板会使用上次的方">
<meta property="og:type" content="article">
<meta property="og:title" content="&#39;使用PHP编写留言板Version2.0&#39;">
<meta property="og:url" content="https://chirec.github.io/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/index.html">
<meta property="og:site_name" content="Emerald Dream">
<meta property="og:description" content="1.改进在上一篇使用PHP编写留言板的结尾处，写了留言板的不足之处。经过一周的PHP学习，打算重新写一遍留言板，对之前的不足做出改进。 1.1删除功能新的留言板添加了编辑选项，可以修改留言内容或删除留言。 1.2重复提交新的留言板添加了session，而且在提交表单之后会自动跳转到留言板的主页，从而解决了重复提交的Bug。 1.3时间显示问题在上一篇其实已经写出了解决方案，新的留言板会使用上次的方">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://chirec.github.io/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/03.01.user_structure.png">
<meta property="og:image" content="https://chirec.github.io/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/03.02.messages_structure.png">
<meta property="og:updated_time" content="2019-03-31T07:40:39.172Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="&#39;使用PHP编写留言板Version2.0&#39;">
<meta name="twitter:description" content="1.改进在上一篇使用PHP编写留言板的结尾处，写了留言板的不足之处。经过一周的PHP学习，打算重新写一遍留言板，对之前的不足做出改进。 1.1删除功能新的留言板添加了编辑选项，可以修改留言内容或删除留言。 1.2重复提交新的留言板添加了session，而且在提交表单之后会自动跳转到留言板的主页，从而解决了重复提交的Bug。 1.3时间显示问题在上一篇其实已经写出了解决方案，新的留言板会使用上次的方">
<meta name="twitter:image" content="https://chirec.github.io/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/03.01.user_structure.png">






  <link rel="canonical" href="https://chirec.github.io/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>'使用PHP编写留言板Version2.0' | Emerald Dream</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Emerald Dream</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

  <a href="https://github.com/ChireC" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://chirec.github.io/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chessur">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Emerald Dream">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">'使用PHP编写留言板Version2.0'

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-29 16:37:23" itemprop="dateCreated datePublished" datetime="2019-03-29T16:37:23+08:00">2019-03-29</time>
            

            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="1-改进"><a href="#1-改进" class="headerlink" title="1.改进"></a>1.改进</h1><p>在上一篇<a href="https://chirec.github.io/2019/03/24/Create-Message-Board-with-PHP/">使用PHP编写留言板</a>的结尾处，写了留言板的不足之处。经过一周的PHP学习，打算重新写一遍留言板，对之前的不足做出改进。</p>
<h2 id="1-1删除功能"><a href="#1-1删除功能" class="headerlink" title="1.1删除功能"></a>1.1删除功能</h2><p>新的留言板添加了编辑选项，可以修改留言内容或删除留言。</p>
<h2 id="1-2重复提交"><a href="#1-2重复提交" class="headerlink" title="1.2重复提交"></a>1.2重复提交</h2><p>新的留言板添加了session，而且在提交表单之后会自动跳转到留言板的主页，从而解决了重复提交的Bug。</p>
<h2 id="1-3时间显示问题"><a href="#1-3时间显示问题" class="headerlink" title="1.3时间显示问题"></a>1.3时间显示问题</h2><p>在上一篇其实已经写出了解决方案，新的留言板会使用上次的方案来解决时间显示问题。</p>
<a id="more"></a>
<h1 id="2-功能介绍"><a href="#2-功能介绍" class="headerlink" title="2.功能介绍"></a>2.功能介绍</h1><h2 id="2-1删除留言"><a href="#2-1删除留言" class="headerlink" title="2.1删除留言"></a>2.1删除留言</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	if(empty($_SESSION[&apos;userName&apos;]))&#123;</span><br><span class="line">		header(&quot;location:login_page.php&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	$userName=$_SESSION[&apos;userName&apos;];</span><br><span class="line">	$message_ID=$_GET[&apos;id&apos;];</span><br><span class="line">	$ip=&quot;localhost&quot;;</span><br><span class="line">	$account=&quot;root&quot;;</span><br><span class="line">	$password=&quot;root&quot;;</span><br><span class="line">	$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">	$query=&quot;delete from messages where ID=$message_ID;&quot;;</span><br><span class="line">	$res=$connect-&gt;prepare($query);</span><br><span class="line">	$res-&gt;execute();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>删除功能的实现，是通过在编辑页面点击链接时使用GET方式传入留言的ID，获得留言的ID后，通过PDO操作数据库删除留言。</p>
<h2 id="2-2登陆"><a href="#2-2登陆" class="headerlink" title="2.2登陆"></a>2.2登陆</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	session_start();</span><br><span class="line">	header(&quot;Content-Type:text/html; charset=utf-8&quot;);</span><br><span class="line">	$ip=&quot;localhost&quot;;</span><br><span class="line">	$account=&quot;root&quot;;</span><br><span class="line">	$password=&quot;root&quot;;</span><br><span class="line">	//连接MySQL数据库</span><br><span class="line">	try&#123;</span><br><span class="line">		//连接数据库</span><br><span class="line">		$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">		echo &quot;Connect successed.&quot;.&quot;&lt;br&gt;&quot;;</span><br><span class="line">		//用户提交登陆信息</span><br><span class="line">		$userName=$_POST[&apos;userName&apos;];</span><br><span class="line">		$pwd=$_POST[&apos;password&apos;];</span><br><span class="line">		//数据库查询语句</span><br><span class="line">		$query=&quot;select Password from user where userName=&apos;$userName&apos;&quot;;</span><br><span class="line">		//</span><br><span class="line">		$res=$connect-&gt;prepare($query);</span><br><span class="line">		$res-&gt;execute();</span><br><span class="line">		$result=$res-&gt;fetch(PDO::FETCH_ASSOC);</span><br><span class="line">		if($pwd==$result[&apos;Password&apos;])&#123;</span><br><span class="line">			echo &quot;登陆成功&quot;;</span><br><span class="line">			$_SESSION[&apos;userName&apos;]=$userName;</span><br><span class="line">			header(&quot;location:home.php&quot;);</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			echo &quot;登陆失败&quot;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;catch(PDOException $error)&#123;</span><br><span class="line">		echo &quot;Connect failed.&quot;.$error-&gt;getmessage();</span><br><span class="line">	&#125;</span><br><span class="line">	$connect=NULL;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-3退出"><a href="#2-3退出" class="headerlink" title="2.3退出"></a>2.3退出</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	unset($_SESSION[&apos;userName&apos;]);</span><br><span class="line">	session_destroy();</span><br><span class="line">	header(&quot;location:login_page.php&quot;);	</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-4发布留言"><a href="#2-4发布留言" class="headerlink" title="2.4发布留言"></a>2.4发布留言</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	if(empty($_SESSION[&apos;userName&apos;]))&#123;</span><br><span class="line">		header(&quot;location:login_page.php&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	$userName=$_SESSION[&apos;userName&apos;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">	$ip=&quot;localhost&quot;;</span><br><span class="line">	$account=&quot;root&quot;;</span><br><span class="line">	$password=&quot;root&quot;;</span><br><span class="line">	$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">	$receiver=$_POST[&apos;receiver&apos;];</span><br><span class="line">	$time=date(&quot;Y-m-d H-i-s&quot;);</span><br><span class="line">	$content=$_POST[&apos;content&apos;];</span><br><span class="line">	$query=&quot;insert into `messages` (sender,receiver,time,content) values(&apos;$userName&apos;,&apos;$receiver&apos;,&apos;$time&apos;,&apos;$content&apos;);&quot;;</span><br><span class="line">	$res=$connect-&gt;prepare($query);</span><br><span class="line">	$res-&gt;execute();</span><br><span class="line">	$connect=NULL;</span><br><span class="line">	header(&quot;location:home.php&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-5注册"><a href="#2-5注册" class="headerlink" title="2.5注册"></a>2.5注册</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	header(&quot;Content-Type:text/html; charset=utf-8&quot;);</span><br><span class="line">	$ip=&quot;localhost&quot;;</span><br><span class="line">	$account=&quot;root&quot;;</span><br><span class="line">	$password=&quot;root&quot;;</span><br><span class="line">	//连接MySQL数据库</span><br><span class="line">	try&#123;</span><br><span class="line">		//连接数据库</span><br><span class="line">		$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">		echo &quot;Connect successed.&quot;.&quot;&lt;br&gt;&quot;;</span><br><span class="line">		//用户提交登陆信息</span><br><span class="line">		$userName=$_POST[&apos;userName&apos;];</span><br><span class="line">		$pwd=$_POST[&apos;password&apos;];</span><br><span class="line">		$Name=$_POST[&apos;Name&apos;];</span><br><span class="line">		//数据库查询语句</span><br><span class="line">		$query=&quot;insert into `user` (userName,Password,Name) value(&apos;$userName&apos;,&apos;$pwd&apos;,&apos;$Name&apos;);&quot;;</span><br><span class="line">		//</span><br><span class="line">		if($_POST[&apos;userName&apos;]==&quot;&quot;or$_POST[&apos;password&apos;]==&quot;&quot;or$_POST[&apos;Name&apos;]==&quot;&quot;)&#123;</span><br><span class="line">			echo &quot;不能为空&quot;;</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			$res=$connect-&gt;exec($query);</span><br><span class="line">			if($res!=0)&#123;</span><br><span class="line">				echo &quot;注册成功&quot;;</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">				echo &quot;注册失败&quot;;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;catch(PDOException $error)&#123;</span><br><span class="line">		echo &quot;Connect failed.&quot;.$error-&gt;getmessage();</span><br><span class="line">	&#125;</span><br><span class="line">	$connect=NULL;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-6编辑留言"><a href="#2-6编辑留言" class="headerlink" title="2.6编辑留言"></a>2.6编辑留言</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	session_start();</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">empty</span>($_SESSION[<span class="string">'userName'</span>]))&#123;</span><br><span class="line">		header(<span class="string">"location:login_page.php"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	$userName=$_SESSION[<span class="string">'userName'</span>];</span><br><span class="line">	$message_ID=$_POST[<span class="string">'ID'</span>];</span><br><span class="line">	$ip=<span class="string">"localhost"</span>;</span><br><span class="line">	$account=<span class="string">"root"</span>;</span><br><span class="line">	$password=<span class="string">"root"</span>;</span><br><span class="line">	$receiver=$_POST[<span class="string">'receiver'</span>];</span><br><span class="line">	$time=date(<span class="string">"Y-m-d H-i-s"</span>);</span><br><span class="line">	$content=$_POST[<span class="string">'content'</span>];</span><br><span class="line">	$ID=$_POST[<span class="string">'ID'</span>];</span><br><span class="line">	$connect=<span class="keyword">new</span> pdo(<span class="string">"mysql:host=$ip;dbname=MessageBoard"</span>,$account,$password);</span><br><span class="line">	$query=<span class="string">"update `messages` set receiver='$receiver',time='$time',content='$content' where ID='$ID';"</span>;</span><br><span class="line">	$res=$connect-&gt;prepare($query);</span><br><span class="line">	$res-&gt;execute();</span><br><span class="line">	$connect=<span class="keyword">NULL</span>;</span><br><span class="line">	header(<span class="string">"location:home.php"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>编辑留言功能实现的方式和删除留言的一样的，都是通过在编辑页面使用GET方式将留言ID传入到编辑留言页面，再通过一个隐藏的表单将留言ID所使用POST方式传入到编辑页面功能中，然后再使用PDO操作数据库编辑留言。</p>
<h2 id="2-7Session"><a href="#2-7Session" class="headerlink" title="2.7Session"></a>2.7Session</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">session_start();</span><br><span class="line">$_SESSEION[<span class="string">'userName'</span>]=$userName;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($_SESSION[<span class="string">'userName'</span>]))&#123;</span><br><span class="line">		header(<span class="string">"location:login_page.php"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">unset</span>($_SESSION[<span class="string">'userName'</span>];</span><br><span class="line">session_destory();</span><br></pre></td></tr></table></figure>
<h3 id="2-7-1session-start"><a href="#2-7-1session-start" class="headerlink" title="2.7.1session_start()"></a>2.7.1session_start()</h3><p>在把用户信息存储在$_SESSION数组之前，必须先启动会话。<br>session_start()就是启动会话的函数。session_start()这个函数一般写在最开始的地方，在&lt;html&gt;标签之前即可。</p>
<h3 id="2-7-2存储或取回session变量"><a href="#2-7-2存储或取回session变量" class="headerlink" title="2.7.2存储或取回session变量"></a>2.7.2存储或取回session变量</h3><p>存储或取回都需要使用到$_SESSION变量。<br>上面的代码中，将用户登录名（userName）存储到了$_SESSION中，在后面比对是也使用的是userName。</p>
<h3 id="2-7-3简单的登陆判断"><a href="#2-7-3简单的登陆判断" class="headerlink" title="2.7.3简单的登陆判断"></a>2.7.3简单的登陆判断</h3><p>使用if判断$_SESSION[‘userName’]是否为空来判断用户是否已经登陆，如果$_SESSION[‘userName’]为空，则跳转到登陆页面。</p>
<h3 id="2-7-4删除session数据"><a href="#2-7-4删除session数据" class="headerlink" title="2.7.4删除session数据"></a>2.7.4删除session数据</h3><p>unset($_SESSION[‘userName’])和session_destory()都可以实现删除session数据的操作。在退出功能中写入，可以确保用户退出留言板。</p>
<h1 id="3-数据库"><a href="#3-数据库" class="headerlink" title="3.数据库"></a>3.数据库</h1><p>MessageBoard数据库有2个表，user表存放用户的注册信息，messages存放用户发布的留言。</p>
<h2 id="3-1user表结构"><a href="#3-1user表结构" class="headerlink" title="3.1user表结构"></a>3.1user表结构</h2><img src="/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/03.01.user_structure.png">
<h2 id="3-2messages表结构"><a href="#3-2messages表结构" class="headerlink" title="3.2messages表结构"></a>3.2messages表结构</h2><img src="/2019/03/29/Create-Message-Board-with-PHP-Version-2-0/03.02.messages_structure.png">
<h1 id="4-显示页面"><a href="#4-显示页面" class="headerlink" title="4.显示页面"></a>4.显示页面</h1><h2 id="4-1编辑页面"><a href="#4-1编辑页面" class="headerlink" title="4.1编辑页面"></a>4.1编辑页面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	if(empty($_SESSION[&apos;userName&apos;]))&#123;</span><br><span class="line">		header(&quot;location:login_page.php&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	$userName=$_SESSION[&apos;userName&apos;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;编辑留言&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1&gt;编辑留言&lt;/h1&gt;</span><br><span class="line">	&lt;?php echo &quot;欢迎&quot;.$userName; ?&gt;</span><br><span class="line">	&lt;a href=&quot;home.php&quot;&gt;返回留言板&lt;/a&gt;</span><br><span class="line">	&lt;a href=&quot;send_message_page.php&quot;&gt;发送留言&lt;/a&gt;</span><br><span class="line">	&lt;a href=&quot;logout.php&quot;&gt;退出留言板&lt;/a&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;th&gt;发送人&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;接收人&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;发送时间&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;留言内容&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;删除&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;编辑&lt;/th&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;?php</span><br><span class="line">			$ip=&quot;localhost&quot;;</span><br><span class="line">			$account=&quot;root&quot;;</span><br><span class="line">			$password=&quot;root&quot;;</span><br><span class="line">			$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">			$query=&quot;select * from messages where sender=&apos;$userName&apos;;&quot;;</span><br><span class="line">			$res=$connect-&gt;prepare($query);</span><br><span class="line">			$res-&gt;execute();</span><br><span class="line">			while ($result=$res-&gt;fetch(PDO::FETCH_ASSOC)) &#123;</span><br><span class="line">				$message_ID=$result[&apos;ID&apos;];</span><br><span class="line">				echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;sender&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;receiver&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;time&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;content&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&lt;a href=&apos;delete_message.php?id=$message_ID&apos;&gt;删除此条留言&lt;/a&gt;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&lt;a href=&apos;update_message_page.php?id=$message_ID&apos;&gt;编辑此条留言&lt;/a&gt;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">			&#125;</span><br><span class="line">		?&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>使用GET方式通过&lt;a&gt;标签将留言ID发送到对应功能或页面。</p>
<h2 id="4-2主页面（显示留言）"><a href="#4-2主页面（显示留言）" class="headerlink" title="4.2主页面（显示留言）"></a>4.2主页面（显示留言）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	if(empty($_SESSION[&apos;userName&apos;]))&#123;</span><br><span class="line">		header(&quot;location:login_page.php&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	$userName=$_SESSION[&apos;userName&apos;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;留言板&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1&gt;留言板&lt;/h1&gt;</span><br><span class="line">	&lt;?php echo &quot;欢迎&quot;.$userName; ?&gt;</span><br><span class="line">	&lt;a href=&quot;logout.php&quot;&gt;退出留言板&lt;/a&gt;</span><br><span class="line">	&lt;a href=&quot;send_message_page.php&quot;&gt;发送留言&lt;/a&gt;</span><br><span class="line">	&lt;a href=&quot;edit_message_page.php&quot;&gt;编辑留言&lt;/a&gt;</span><br><span class="line">	&lt;table border=1&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;th&gt;发送人&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;接收人&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;发送时间&lt;/th&gt;</span><br><span class="line">			&lt;th&gt;留言内容&lt;/th&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;?php</span><br><span class="line">			$ip=&quot;localhost&quot;;</span><br><span class="line">			$account=&quot;root&quot;;</span><br><span class="line">			$password=&quot;root&quot;;</span><br><span class="line">			$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">			$query=&quot;select * from messages where sender=&apos;$userName&apos; or receiver=&apos;$userName&apos; or receiver=&apos;all&apos;;&quot;;</span><br><span class="line">			$res=$connect-&gt;prepare($query);</span><br><span class="line">			$res-&gt;execute();</span><br><span class="line">			while ($result=$res-&gt;fetch(PDO::FETCH_ASSOC)) &#123;</span><br><span class="line">				echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;sender&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;receiver&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;time&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;td&gt;&quot;.$result[&apos;content&apos;].&quot;&lt;/td&gt;&quot;;</span><br><span class="line">				echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">			&#125;</span><br><span class="line">		?&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h2 id="4-3登陆页面"><a href="#4-3登陆页面" class="headerlink" title="4.3登陆页面"></a>4.3登陆页面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;?php session_start(); ?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;留言板&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1&gt;留言板&lt;/h1&gt;</span><br><span class="line">	&lt;a href=&quot;signup_page.php&quot;&gt;注册&lt;/a&gt;</span><br><span class="line">	&lt;form action=&quot;login.php&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">		用户名：&lt;input type=&quot;text&quot; name=&quot;userName&quot;&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		密&amp;nbsp;&amp;nbsp;&amp;nbsp;码：&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=&quot;submit&quot; value=&quot;登陆&quot;&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h2 id="4-4发布留言页面"><a href="#4-4发布留言页面" class="headerlink" title="4.4发布留言页面"></a>4.4发布留言页面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	if(empty($_SESSION[&apos;userName&apos;]))&#123;</span><br><span class="line">		header(&quot;location:login_page.php&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	$userName=$_SESSION[&apos;userName&apos;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;发送留言&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;?php</span><br><span class="line">		$ip=&quot;localhost&quot;;</span><br><span class="line">		$account=&quot;root&quot;;</span><br><span class="line">		$password=&quot;root&quot;;</span><br><span class="line">		$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">		$query=&quot;select Name from user where Name!=&apos;$userName&apos;;&quot;;</span><br><span class="line">		$res=$connect-&gt;prepare($query);</span><br><span class="line">		$res-&gt;execute();</span><br><span class="line">	?&gt;</span><br><span class="line">	&lt;h1&gt;留言&lt;/h1&gt;</span><br><span class="line">	&lt;?php echo &quot;欢迎&quot;.$userName; ?&gt;</span><br><span class="line">	&lt;br&gt;</span><br><span class="line">	&lt;a href=&quot;home.php&quot;&gt;返回留言板&lt;/a&gt;</span><br><span class="line">	&lt;form action=&quot;send_message.php&quot; method=&quot;POST&quot;&gt;	</span><br><span class="line">		接收人:</span><br><span class="line">		&lt;select name=&quot;receiver&quot;&gt;</span><br><span class="line">			&lt;option value=&quot;all&quot;&gt;所有人&lt;/option&gt;</span><br><span class="line">			&lt;?php</span><br><span class="line">				while ($result=$res-&gt;fetch(PDO::FETCH_ASSOC)) &#123;</span><br><span class="line">					$name=$result[&apos;Name&apos;];</span><br><span class="line">					echo &quot;&lt;option value=&apos;$name&apos;&gt;&quot;.$name.&quot;&lt;/option&gt;&quot;;</span><br><span class="line">				&#125;</span><br><span class="line">			?&gt;</span><br><span class="line">		&lt;/select&gt;</span><br><span class="line">		&lt;br&gt;&lt;br&gt;</span><br><span class="line">		&lt;textarea name=&quot;content&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">		&lt;br&gt;&lt;br&gt;</span><br><span class="line">		&lt;input type=&quot;submit&quot;&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h2 id="4-5注册页面"><a href="#4-5注册页面" class="headerlink" title="4.5注册页面"></a>4.5注册页面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;留言板注册&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1&gt;留言板注册&lt;/h1&gt;</span><br><span class="line">	&lt;form action=&quot;signup.php&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">		用户名：&lt;input type=&quot;text&quot; name=&quot;userName&quot;&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		昵&amp;nbsp;&amp;nbsp;&amp;nbsp;称：&lt;input type=&quot;text&quot; name=&quot;Name&quot;&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		密&amp;nbsp;&amp;nbsp;&amp;nbsp;码：&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=&quot;submit&quot; value=&quot;注册&quot;&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h2 id="4-6修改留言页面"><a href="#4-6修改留言页面" class="headerlink" title="4.6修改留言页面"></a>4.6修改留言页面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;?php </span><br><span class="line">	session_start();</span><br><span class="line">	if(empty($_SESSION[&apos;userName&apos;]))&#123;</span><br><span class="line">		header(&quot;location:login_page.php&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	$userName=$_SESSION[&apos;userName&apos;];</span><br><span class="line">	$message_ID=$_GET[&apos;id&apos;];</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;编辑留言&lt;/title&gt;</span><br><span class="line">	&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;?php</span><br><span class="line">		$ip=&quot;localhost&quot;;</span><br><span class="line">		$account=&quot;root&quot;;</span><br><span class="line">		$password=&quot;root&quot;;</span><br><span class="line">		$connect=new pdo(&quot;mysql:host=$ip;dbname=MessageBoard&quot;,$account,$password);</span><br><span class="line">		$query=&quot;select Name from user where Name!=&apos;$userName&apos;;&quot;;</span><br><span class="line">		$res=$connect-&gt;prepare($query);</span><br><span class="line">		$res-&gt;execute();</span><br><span class="line">	?&gt;</span><br><span class="line">	&lt;h1&gt;编辑留言&lt;/h1&gt;</span><br><span class="line">	&lt;?php echo &quot;欢迎&quot;.$userName; ?&gt;</span><br><span class="line">	&lt;a href=&quot;home.php&quot;&gt;返回留言板&lt;/a&gt;</span><br><span class="line">	&lt;a href=&quot;send_message_page.php&quot;&gt;发送留言&lt;/a&gt;</span><br><span class="line">	&lt;a href=&quot;logout.php&quot;&gt;退出留言板&lt;/a&gt;</span><br><span class="line">	&lt;form action=&quot;update_message.php&quot; method=&quot;POST&quot;&gt;	</span><br><span class="line">		接收人:</span><br><span class="line">		&lt;select name=&quot;receiver&quot;&gt;</span><br><span class="line">			&lt;option value=&quot;all&quot;&gt;所有人&lt;/option&gt;</span><br><span class="line">			&lt;?php</span><br><span class="line">				while ($result=$res-&gt;fetch(PDO::FETCH_ASSOC)) &#123;</span><br><span class="line">					$name=$result[&apos;Name&apos;];</span><br><span class="line">					echo &quot;&lt;option value=&apos;$name&apos;&gt;&quot;.$name.&quot;&lt;/option&gt;&quot;;</span><br><span class="line">				&#125;</span><br><span class="line">			?&gt;</span><br><span class="line">		&lt;/select&gt;</span><br><span class="line">		&lt;br&gt;&lt;br&gt;</span><br><span class="line">		&lt;textarea name=&quot;content&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">		&lt;br&gt;&lt;br&gt;</span><br><span class="line">		&lt;input type=&quot;hidden&quot; name=&quot;ID&quot; value=&quot;&lt;?php echo $message_ID; ?&gt;&quot;&gt;</span><br><span class="line">		&lt;input type=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h1 id="5-PDO"><a href="#5-PDO" class="headerlink" title="5.PDO"></a>5.PDO</h1><p>PDO是 PHP Date Object （PHP数据对象）的简称，目前支持的数据库包括Firebird， FreeTDS，Interbase ，MySQL，MS SQL Server， ODBC, Oracle，Postgre SQL，SQLite 以及 Sybase等。有了PDO，用户就不必再使用 mysql_*函数，aco_<em>函数或者 mssql_\</em>函数，也不必再将他们封装到数据库操作类，只需要使用PDO接口中的方法就可以对不同的数据库进行操作，在选择不同数据库时，只需要修改PDO的 DNS（数据库名）就可以了。</p>
<h2 id="5-1PDO构造函数连接数据库"><a href="#5-1PDO构造函数连接数据库" class="headerlink" title="5.1PDO构造函数连接数据库"></a>5.1PDO构造函数连接数据库</h2><p>PDO构造函数的形式：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_construct(string $dsn[,string $username[,string $password[,<span class="keyword">array</span> $driver_options]]])</span><br></pre></td></tr></table></figure>
<p>$dsn：主机IP地址及数据库名称</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$dsn=<span class="string">"mysql:host=$host;dbName=$dbName"</span></span><br></pre></td></tr></table></figure>
<p>$username：数据库用户名<br>$password：数据库密码<br>$driver_options：连接数据库的其他选项</p>
<p>通过PDO连接数据库</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	header(<span class="string">"Content-Type:text/html;charset=utf-8"</span>);</span><br><span class="line">	$host=<span class="string">"localhost"</span>;</span><br><span class="line">	$account=<span class="string">"root"</span>;</span><br><span class="line">	$password=<span class="string">"root"</span>;</span><br><span class="line">	$dbname=<span class="string">"MessageBoard"</span>;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">        $connect=<span class="keyword">new</span> PDO(<span class="string">"mysql:host=$host;dbname=$dbname,$account,$password);</span></span><br><span class="line"><span class="string">        echo "</span>Connect successed.<span class="string">";</span></span><br><span class="line"><span class="string">	&#125;catch (Exception $error)&#123;</span></span><br><span class="line"><span class="string">        echo $error-&gt;getMessage()."</span>&lt;br&gt;<span class="string">";</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="5-2使用PDO执行SQL语句"><a href="#5-2使用PDO执行SQL语句" class="headerlink" title="5.2使用PDO执行SQL语句"></a>5.2使用PDO执行SQL语句</h2><p>在PDO中，可以使用3中方式执行SQL语句，分别是exec()方法，query方法，以及预处理语句prepare()和execute()方法</p>
<h3 id="5-2-1PDO-exec-方法"><a href="#5-2-1PDO-exec-方法" class="headerlink" title="5.2.1PDO::exec()方法"></a>5.2.1PDO::exec()方法</h3><p>exec()方法形式如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int PDO::exec(string $statement)</span><br></pre></td></tr></table></figure>
<p>PDO::exec()执行<strong>一条</strong>SQL语句，并返回受影响的行数。<br>$statement是要执行的SQL语句。</p>
<p>通过exec()方法执行SQL语句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	header(<span class="string">"Content-Type:text/html;charset=utf-8"</span>);</span><br><span class="line">	$host=<span class="string">"localhost"</span>;</span><br><span class="line">	$account=<span class="string">"root"</span>;</span><br><span class="line">	$password=<span class="string">"root"</span>;</span><br><span class="line">	$dbname=<span class="string">"MessageBoard"</span>;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">        $connect=<span class="keyword">new</span> PDO(<span class="string">"mysql:host=$host;dbname=$dbname,$account,$password);</span></span><br><span class="line"><span class="string">        $query="</span>insert into `user` (userName,Password,Name) values(<span class="string">'chessur'</span>,<span class="string">'chessur'</span>,<span class="string">'chessur'</span>);<span class="string">"</span></span><br><span class="line"><span class="string">        $result=$connect-&gt;exec($query);</span></span><br><span class="line"><span class="string">        echo "</span>数据插入成功,受影响行数为：<span class="string">".$result;</span></span><br><span class="line"><span class="string">	&#125;catch (Exception $error)&#123;</span></span><br><span class="line"><span class="string">        echo $error-&gt;getMessage()."</span>&lt;br&gt;<span class="string">";</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-2-2PDO-query-方法"><a href="#5-2-2PDO-query-方法" class="headerlink" title="5.2.2PDO::query()方法"></a>5.2.2PDO::query()方法</h3><p>query()方法形式如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PDOStatement PDO::query(string $statement)</span><br></pre></td></tr></table></figure>
<p>PDO::query()可执行多条SQL语句，并以PDOStatement对象形式返回结果集。</p>
<p>通过PDO::query()执行SQL语句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	header(<span class="string">"Content-Type:text/html;charset=utf-8"</span>);</span><br><span class="line">	$host=<span class="string">"localhost"</span>;</span><br><span class="line">	$account=<span class="string">"root"</span>;</span><br><span class="line">	$password=<span class="string">"root"</span>;</span><br><span class="line">	$dbname=<span class="string">"MessageBoard"</span>;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">        $connect=<span class="keyword">new</span> PDO(<span class="string">"mysql:host=$host;dbname=$dbname,$account,$password);</span></span><br><span class="line"><span class="string">        $query="</span>insert into `user` (userName,Password,Name) values(<span class="string">'chessur'</span>,<span class="string">'chessur'</span>,<span class="string">'chessur'</span>);<span class="string">"</span></span><br><span class="line"><span class="string">        $result=$connect-&gt;query($query);</span></span><br><span class="line"><span class="string">        print_r($result);</span></span><br><span class="line"><span class="string">	&#125;catch (Exception $error)&#123;</span></span><br><span class="line"><span class="string">        echo $error-&gt;getMessage()."</span>&lt;br&gt;<span class="string">";</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5-2-3预处理语句：PDO-prepare-语句和execute-语句"><a href="#5-2-3预处理语句：PDO-prepare-语句和execute-语句" class="headerlink" title="5.2.3预处理语句：PDO::prepare()语句和execute()语句"></a>5.2.3预处理语句：PDO::prepare()语句和execute()语句</h3><p>PDO::prepare()方法形式如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PDOStatement PDO::prepare(string $statement[,<span class="keyword">array</span> $driver_options])</span><br></pre></td></tr></table></figure>
<p>PDOStatement::execute方法形式如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool PDOStatement::execute([<span class="keyword">array</span> $input_parameters])</span><br></pre></td></tr></table></figure>
<p>PDO::prepare()方法为PDOStatement::execute()方法准备待执行的SQL语句。SQL 语句可以包含零个或多个参数占位标记，格式是命名（:name）或问号（?）的形式，当它执行时将用真实数据取代。 在同一个 SQL 语句里，命名形式和问号形式不能同时使用；只能选择其中一种参数形式。<br>PDOStatement::execute()方法执行一条预处理语句。</p>
<p>使用预处理语句执行SQL语句：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	header(<span class="string">"Content-Type:text/html;charset=utf-8"</span>);</span><br><span class="line">	$host=<span class="string">"localhost"</span>;</span><br><span class="line">	$account=<span class="string">"root"</span>;</span><br><span class="line">	$password=<span class="string">"root"</span>;</span><br><span class="line">	$dbname=<span class="string">"MessageBoard"</span>;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">        $connect=<span class="keyword">new</span> PDO(<span class="string">"mysql:host=$host;dbname=$dbname,$account,$password);</span></span><br><span class="line"><span class="string">        $query="</span>insert into `user` (userName,Password,Name) values(<span class="string">'chessur'</span>,<span class="string">'chessur'</span>,<span class="string">'chessur'</span>);<span class="string">"</span></span><br><span class="line"><span class="string">        $result=$connect-&gt;prepare($query);</span></span><br><span class="line"><span class="string">        $res-&gt;execute();</span></span><br><span class="line"><span class="string">        while($result=$result-&gt;fetch(PDO::FETCH_ASSOC))&#123;</span></span><br><span class="line"><span class="string">            echo $result['userName'].$result['Password'].$result[Name];</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">	&#125;catch (Exception $error)&#123;</span></span><br><span class="line"><span class="string">        echo $error-&gt;getMessage()."</span>&lt;br&gt;<span class="string">";</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="5-3PDOStatement-fetch"><a href="#5-3PDOStatement-fetch" class="headerlink" title="5.3PDOStatement::fetch"></a>5.3PDOStatement::fetch</h2><h3 id="5-3-1PDOStatement-fetch"><a href="#5-3-1PDOStatement-fetch" class="headerlink" title="5.3.1PDOStatement::fetch"></a>5.3.1PDOStatement::fetch</h3><p>PDOStatement::fetch形式如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mixed PDOStatement::fetch ([ int $fetch_style [, int $cursor_orientation = PDO::FETCH_ORI_NEXT [, int $cursor_offset = <span class="number">0</span> ]]] )</span><br></pre></td></tr></table></figure>
<h4 id="5-3-1-1参数-fetch-style"><a href="#5-3-1-1参数-fetch-style" class="headerlink" title="5.3.1.1参数-$fetch_style"></a>5.3.1.1参数-$fetch_style</h4><p>控制下一行如何返回给调用者。此值必须是 PDO::FETCH_* 系列常量中的一个，缺省为 PDO::ATTR_DEFAULT_FETCH_MODE的值 （默认为 PDO::FETCH_BOTH）。</p>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">效果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">PDO::FETCH_ASSOC</td>
<td style="text-align:center">返回一个索引为结果集列名的数组</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_BOTH（默认）</td>
<td style="text-align:center">返回一个索引为结果集列名和以0开始的列号的数组</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_BOUND</td>
<td style="text-align:center">返回 TRUE ，并分配结果集中的列值给 PDOStatement::bindColumn() 方法绑定的 PHP 变量。</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_CLASS</td>
<td style="text-align:center">返回一个请求类的新实例，映射结果集中的列名到类中对应的属性名。如果 fetch_style 包含 PDO::FETCH_CLASSTYPE（例如：PDO::FETCH_CLASS</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_INTO</td>
<td style="text-align:center">更新一个被请求类已存在的实例，映射结果集中的列到类中命名的属性</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_LAZY</td>
<td style="text-align:center">结合使用 PDO::FETCH_BOTH 和 PDO::FETCH_OBJ，创建供用来访问的对象变量名</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_NUM</td>
<td style="text-align:center">返回一个索引为以0开始的结果集列号的数组</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_OBJ</td>
<td style="text-align:center">返回一个属性名对应结果集列名的匿名对象</td>
</tr>
</tbody>
</table>
<h4 id="5-3-1-2参数-cursor-orientation"><a href="#5-3-1-2参数-cursor-orientation" class="headerlink" title="5.3.1.2参数-$cursor_orientation"></a>5.3.1.2参数-$cursor_orientation</h4><p>对于 一个 PDOStatement 对象表示的可滚动游标，该值决定了哪一行将被返回给调用者。此值必须是 PDO::FETCH_ORI_* 系列常量中的一个，默认为 PDO::FETCH_ORI_NEXT。要想让 PDOStatement 对象使用可滚动游标，必须在用 PDO::prepare() 预处理SQL语句时，设置 PDO::ATTR_CURSOR 属性为 PDO::CURSOR_SCROLL。</p>
<h4 id="5-3-1-3参数-offset"><a href="#5-3-1-3参数-offset" class="headerlink" title="5.3.1.3参数-$offset"></a>5.3.1.3参数-$offset</h4><p>对于一个 cursor_orientation 参数设置为 PDO::FETCH_ORI_ABS 的PDOStatement 对象代表的可滚动游标，此值指定结果集中想要获取行的绝对行号。</p>
<p>对于一个 cursor_orientation 参数设置为 PDO::FETCH_ORI_REL 的PDOStatement 对象代表的可滚动游标，此值指定想要获取行相对于调用 PDOStatement::fetch() 前游标的位置</p>
<h3 id="5-3-2PDOStatement-fetchAll"><a href="#5-3-2PDOStatement-fetchAll" class="headerlink" title="5.3.2PDOStatement::fetchAll"></a>5.3.2PDOStatement::fetchAll</h3><p>PDOStatement::fetchAll形式如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span> PDOStatement::fetchAll ([ int $fetch_style [, mixed $fetch_argument [, <span class="keyword">array</span> $ctor_args = <span class="keyword">array</span>() ]]] )</span><br></pre></td></tr></table></figure>
<h4 id="5-3-2-1参数-fetch-style"><a href="#5-3-2-1参数-fetch-style" class="headerlink" title="5.3.2.1参数-$fetch_style"></a>5.3.2.1参数-$fetch_style</h4><p>控制返回数组的内容如同 PDOStatement::fetch() 文档中记载的一样。默认为 PDO::ATTR_DEFAULT_FETCH_MODE 的值（ 其缺省值为 PDO::FETCH_BOTH ）</p>
<p>想要返回一个包含结果集中单独一列所有值的数组，需要指定 PDO::FETCH_COLUMN 。通过指定 column-index 参数获取想要的列。</p>
<p>想要获取结果集中单独一列的唯一值，需要将 PDO::FETCH_COLUMN 和 PDO::FETCH_UNIQUE 按位或。</p>
<p>想要返回一个根据指定列把值分组后的关联数组，需要将 PDO::FETCH_COLUMN 和 PDO::FETCH_GROUP 按位或。</p>
<h4 id="5-3-2-2参数-fetch-argument"><a href="#5-3-2-2参数-fetch-argument" class="headerlink" title="5.3.2.2参数-$fetch_argument"></a>5.3.2.2参数-$fetch_argument</h4><table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">效果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">PDO::FETCH_COLUMN</td>
<td style="text-align:center">返回指定以0开始索引的列</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_CLASS</td>
<td style="text-align:center">返回指定类的实例，映射每行的列到类中对应的属性名</td>
</tr>
<tr>
<td style="text-align:center">PDO::FETCH_FUNC</td>
<td style="text-align:center">将每行的列作为参数传递给指定的函数，并返回调用函数后的结果</td>
</tr>
</tbody>
</table>
<h4 id="5-3-2-3参数-ctor-args"><a href="#5-3-2-3参数-ctor-args" class="headerlink" title="5.3.2.3参数-$ctor_args"></a>5.3.2.3参数-$ctor_args</h4><p>当 fetch_style 参数为 PDO::FETCH_CLASS 时，自定义类的构造函数的参数。</p>
<h3 id="5-3-3PDOStatement-fetchColumn"><a href="#5-3-3PDOStatement-fetchColumn" class="headerlink" title="5.3.3PDOStatement::fetchColumn"></a>5.3.3PDOStatement::fetchColumn</h3><p>PDOStatement::fetchColumn形式如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string PDOStatement::fetchColumn ([ int $column_number = <span class="number">0</span> ] )</span><br></pre></td></tr></table></figure>
<h4 id="5-3-3-1参数-column-number"><a href="#5-3-3-1参数-column-number" class="headerlink" title="5.3.3.1参数-column_number"></a>5.3.3.1参数-column_number</h4><p>你想从行里取回的列的索引数字（以0开始的索引）。如果没有提供值，则 PDOStatement::fetchColumn() 获取第一列。</p>
<h3 id="5-3-4PDOStatement-fetchObject"><a href="#5-3-4PDOStatement-fetchObject" class="headerlink" title="5.3.4PDOStatement::fetchObject"></a>5.3.4PDOStatement::fetchObject</h3><p>PDOStatement::fetchObject形式如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mixed PDOStatement::fetchObject ([ string $class_name = <span class="string">"stdClass"</span> [, <span class="keyword">array</span> $ctor_args ]] )</span><br></pre></td></tr></table></figure>
<h4 id="5-3-4-1参数-class-name"><a href="#5-3-4-1参数-class-name" class="headerlink" title="5.3.4.1参数-class_name"></a>5.3.4.1参数-class_name</h4><p>创建类的名称。</p>
<h4 id="5-3-4-2参数-ctor-args"><a href="#5-3-4-2参数-ctor-args" class="headerlink" title="5.3.4.2参数-ctor_args"></a>5.3.4.2参数-ctor_args</h4><p>此数组的元素被传递给构造函数。</p>
<h1 id="6-缺陷"><a href="#6-缺陷" class="headerlink" title="6.缺陷"></a>6.缺陷</h1><p>没有考虑防御手段。</p>
<h1 id="7-参考"><a href="#7-参考" class="headerlink" title="7.参考"></a>7.参考</h1><p>[1] <a href="https://www.cnblogs.com/xiaodouding/p/6504728.html" target="_blank" rel="noopener">php实现留言板功能</a></p>
<p>[2] <a href="http://www.php.cn/php-weizijiaocheng-361204.html" target="_blank" rel="noopener">PDO中执行SQL语句的三种方法</a></p>
<p>[3] <a href="http://www.php.cn/php-weizijiaocheng-361205.html" target="_blank" rel="noopener">PDO中获取结果集之fetch()方法详解</a></p>
<p>[4] <a href="https://www.w3cschool.cn/t_sql/" target="_blank" rel="noopener">T-SQL教程</a></p>
<p>[5] <a href="http://www.w3school.com.cn/php/php_sessions.asp" target="_blank" rel="noopener">PHP Sessions</a></p>
<p>[6] <a href="https://www.php.net/manual/zh/book.pdo.php" target="_blank" rel="noopener">PHP:PDO-Manual</a></p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/03/26/I-can-not-see-U/" rel="next" title="'使用Ettercap和SET进行DNS欺骗、钓鱼'">
                <i class="fa fa-chevron-left"></i> '使用Ettercap和SET进行DNS欺骗、钓鱼'
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/04/08/I-Want-to-see-U/" rel="prev" title="'使用Ettercap和MSF模块进行DNS欺骗，并植入后门'">
                '使用Ettercap和MSF模块进行DNS欺骗，并植入后门' <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">chessur</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/ChireC" title="GitHub &rarr; https://github.com/ChireC" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-改进"><span class="nav-text">1.改进</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1删除功能"><span class="nav-text">1.1删除功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2重复提交"><span class="nav-text">1.2重复提交</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3时间显示问题"><span class="nav-text">1.3时间显示问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-功能介绍"><span class="nav-text">2.功能介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1删除留言"><span class="nav-text">2.1删除留言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2登陆"><span class="nav-text">2.2登陆</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3退出"><span class="nav-text">2.3退出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4发布留言"><span class="nav-text">2.4发布留言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5注册"><span class="nav-text">2.5注册</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6编辑留言"><span class="nav-text">2.6编辑留言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7Session"><span class="nav-text">2.7Session</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-1session-start"><span class="nav-text">2.7.1session_start()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-2存储或取回session变量"><span class="nav-text">2.7.2存储或取回session变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-3简单的登陆判断"><span class="nav-text">2.7.3简单的登陆判断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-4删除session数据"><span class="nav-text">2.7.4删除session数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-数据库"><span class="nav-text">3.数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1user表结构"><span class="nav-text">3.1user表结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2messages表结构"><span class="nav-text">3.2messages表结构</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-显示页面"><span class="nav-text">4.显示页面</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1编辑页面"><span class="nav-text">4.1编辑页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2主页面（显示留言）"><span class="nav-text">4.2主页面（显示留言）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3登陆页面"><span class="nav-text">4.3登陆页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4发布留言页面"><span class="nav-text">4.4发布留言页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5注册页面"><span class="nav-text">4.5注册页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6修改留言页面"><span class="nav-text">4.6修改留言页面</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-PDO"><span class="nav-text">5.PDO</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1PDO构造函数连接数据库"><span class="nav-text">5.1PDO构造函数连接数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2使用PDO执行SQL语句"><span class="nav-text">5.2使用PDO执行SQL语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-1PDO-exec-方法"><span class="nav-text">5.2.1PDO::exec()方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-2PDO-query-方法"><span class="nav-text">5.2.2PDO::query()方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-3预处理语句：PDO-prepare-语句和execute-语句"><span class="nav-text">5.2.3预处理语句：PDO::prepare()语句和execute()语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3PDOStatement-fetch"><span class="nav-text">5.3PDOStatement::fetch</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-1PDOStatement-fetch"><span class="nav-text">5.3.1PDOStatement::fetch</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-1参数-fetch-style"><span class="nav-text">5.3.1.1参数-$fetch_style</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-2参数-cursor-orientation"><span class="nav-text">5.3.1.2参数-$cursor_orientation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-3参数-offset"><span class="nav-text">5.3.1.3参数-$offset</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-2PDOStatement-fetchAll"><span class="nav-text">5.3.2PDOStatement::fetchAll</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-2-1参数-fetch-style"><span class="nav-text">5.3.2.1参数-$fetch_style</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-2-2参数-fetch-argument"><span class="nav-text">5.3.2.2参数-$fetch_argument</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-2-3参数-ctor-args"><span class="nav-text">5.3.2.3参数-$ctor_args</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-3PDOStatement-fetchColumn"><span class="nav-text">5.3.3PDOStatement::fetchColumn</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-3-1参数-column-number"><span class="nav-text">5.3.3.1参数-column_number</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-4PDOStatement-fetchObject"><span class="nav-text">5.3.4PDOStatement::fetchObject</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-4-1参数-class-name"><span class="nav-text">5.3.4.1参数-class_name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-4-2参数-ctor-args"><span class="nav-text">5.3.4.2参数-ctor_args</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-缺陷"><span class="nav-text">6.缺陷</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-参考"><span class="nav-text">7.参考</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chessur</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  



  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="/lib/reading_progress/reading_progress.js"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
